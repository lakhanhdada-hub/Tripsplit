<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TripSplit Full</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>

<body class="bg-slate-100">
<div id="root"></div>

<script type="text/babel">
const {useState,useEffect,useMemo}=React;

const App=()=>{
 const [members,setMembers]=useState(()=>JSON.parse(localStorage.getItem("m")||"[]"));
 const [expenses,setExpenses]=useState(()=>JSON.parse(localStorage.getItem("e")||"[]"));
 const [name,setName]=useState("");
 const [desc,setDesc]=useState("");
 const [amount,setAmount]=useState("");

 useEffect(()=>{
  localStorage.setItem("m",JSON.stringify(members));
  localStorage.setItem("e",JSON.stringify(expenses));
 },[members,expenses]);

 const addMember=()=>{
  if(!name)return;
  setMembers([...members,{id:Date.now().toString(),name}]);
  setName("");
 };

 const addExpense=()=>{
  const v=parseFloat(amount);
  if(!desc||isNaN(v)||v<=0)return;
  setExpenses([{id:Date.now().toString(),desc,amount:v,date:new Date().toLocaleString("vi-VN")},...expenses]);
  setDesc("");setAmount("");
 };

 const total=useMemo(()=>expenses.reduce((s,e)=>s+e.amount,0),[expenses]);

 return(
 <div className="max-w-md mx-auto p-4 space-y-4">
  <h1 className="text-2xl font-black text-center">TRIPSPLIT FULL</h1>

  <div className="bg-white p-4 rounded-xl shadow space-y-2">
   <input className="w-full p-2 bg-slate-100 rounded" placeholder="Tên thành viên"
    value={name} onChange={e=>setName(e.target.value)}/>
   <button onClick={addMember} className="w-full bg-indigo-600 text-white py-2 rounded font-bold">
    + Thêm thành viên
   </button>
  </div>

  {members.length>0&&(
  <div className="bg-white p-4 rounded-xl shadow space-y-2">
   <input className="w-full p-2 bg-slate-100 rounded" placeholder="Nội dung chi"
    value={desc} onChange={e=>setDesc(e.target.value)}/>
   <input type="number" className="w-full p-2 bg-slate-100 rounded" placeholder="Số tiền"
    value={amount} onChange={e=>setAmount(e.target.value)}/>
   <button onClick={addExpense} className="w-full bg-rose-500 text-white py-2 rounded font-bold">
    + Thêm chi tiêu
   </button>
  </div>
  )}

  <div className="bg-white p-4 rounded-xl shadow">
   <p className="font-bold">Tổng chi: {total.toLocaleString()} K</p>
  </div>

  <div className="space-y-2">
   {expenses.map(e=>(
    <div key={e.id} className="bg-white p-3 rounded-xl shadow flex justify-between">
     <div>
      <p className="font-bold">{e.desc}</p>
      <p className="text-xs text-slate-400">{e.date}</p>
     </div>
     <p className="font-black text-rose-500">-{e.amount}K</p>
    </div>
   ))}
  </div>
 </div>
 );
};

ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
</script>
</body>
</html>
